<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Train Adventure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            background: linear-gradient(to bottom, #87CEEB 0%, #E0F6FF 100%);
        }

        #gameCanvas {
            display: block;
            margin: 0 auto;
            background: linear-gradient(to bottom, #87CEEB 0%, #90EE90 70%, #8B7355 70%, #654321 100%);
        }

        .game-ui {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-size: 24px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 10;
        }

        .score {
            background: rgba(0,0,0,0.5);
            padding: 10px 20px;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .instructions {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            color: white;
            font-size: 14px;
            max-width: 200px;
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            color: white;
            display: none;
            z-index: 100;
        }

        .game-over h2 {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #ff6b6b;
        }

        .game-over button {
            padding: 15px 40px;
            font-size: 1.2rem;
            border: none;
            border-radius: 10px;
            background: #4ecdc4;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            margin-top: 20px;
        }

        .game-over button:hover {
            background: #45b7aa;
            transform: scale(1.05);
        }

        .start-screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            color: white;
            z-index: 100;
        }

        .start-screen h1 {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .start-screen button {
            padding: 15px 40px;
            font-size: 1.2rem;
            border: none;
            border-radius: 10px;
            background: #4ecdc4;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            margin-top: 20px;
        }

        .start-screen button:hover {
            background: #45b7aa;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    
    <div class="game-ui">
        <div class="score">Score: <span id="score">0</span></div>
        <div class="score">Speed: <span id="speed">1</span>x</div>
    </div>

    <div class="instructions">
        <strong>Controls:</strong><br>
        â†‘ - Jump<br>
        â†“ - Duck<br>
        <br>
        Avoid obstacles and collect coins!
    </div>

    <div class="start-screen" id="startScreen">
        <h1>ðŸš‚ Train Adventure</h1>
        <p style="font-size: 1.2rem; margin-bottom: 20px;">Guide the train through obstacles and collect coins!</p>
        <button onclick="startGame()">Start Game</button>
    </div>

    <div class="game-over" id="gameOver">
        <h2>Game Over!</h2>
        <p style="font-size: 1.5rem; margin-bottom: 10px;">Final Score: <span id="finalScore">0</span></p>
        <p style="font-size: 1.2rem;">Coins Collected: <span id="finalCoins">0</span></p>
        <button onclick="restartGame()">Play Again</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let gameRunning = false;
        let score = 0;
        let coins = 0;
        let gameSpeed = 5;
        let speedMultiplier = 1;

        const train = {
            x: 100,
            y: 400,
            width: 80,
            height: 60,
            velocityY: 0,
            jumping: false,
            ducking: false,
            normalHeight: 60,
            duckHeight: 35
        };

        const gravity = 0.8;
        const jumpPower = -15;
        const groundY = 400;

        let obstacles = [];
        let coinObjects = [];
        let clouds = [];
        let frameCount = 0;

        for (let i = 0; i < 5; i++) {
            clouds.push({
                x: Math.random() * canvas.width,
                y: Math.random() * 150 + 50,
                width: Math.random() * 60 + 40,
                speed: Math.random() * 0.5 + 0.3
            });
        }

        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            gameRunning = true;
            score = 0;
            coins = 0;
            gameSpeed = 5;
            speedMultiplier = 1;
            obstacles = [];
            coinObjects = [];
            train.y = groundY;
            train.velocityY = 0;
            train.jumping = false;
            train.ducking = false;
            train.height = train.normalHeight;
            gameLoop();
        }

        function restartGame() {
            document.getElementById('gameOver').style.display = 'none';
            startGame();
        }

        function drawTrain() {
            ctx.fillStyle = '#ff4444';
            
            if (train.ducking) {
                ctx.fillRect(train.x, train.y + 25, train.width, train.height);
                ctx.fillStyle = '#cc0000';
                ctx.fillRect(train.x + 10, train.y + 30, 20, 20);
            } else {
                ctx.fillRect(train.x, train.y, train.width, train.height);
                ctx.fillStyle = '#ffff00';
                ctx.fillRect(train.x + 5, train.y + 5, 15, 15);
                ctx.fillRect(train.x + 25, train.y + 5, 15, 15);
                ctx.fillStyle = '#333';
                ctx.fillRect(train.x + 50, train.y + 15, 25, 30);
            }
            
            ctx.fillStyle = '#000';
            let wheelY = train.ducking ? train.y + train.height + 15 : train.y + train.height - 5;
            ctx.beginPath();
            ctx.arc(train.x + 20, wheelY, 10, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(train.x + 60, wheelY, 10, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawObstacles() {
            obstacles.forEach(obs => {
                if (obs.type === 'rock') {
                    ctx.fillStyle = '#666';
                    ctx.beginPath();
                    ctx.moveTo(obs.x + obs.width / 2, obs.y);
                    ctx.lineTo(obs.x + obs.width, obs.y + obs.height);
                    ctx.lineTo(obs.x, obs.y + obs.height);
                    ctx.closePath();
                    ctx.fill();
                } else if (obs.type === 'tunnel') {
                    ctx.fillStyle = '#8B4513';
                    ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
                    ctx.fillStyle = '#000';
                    ctx.fillRect(obs.x + 5, obs.y + 5, obs.width - 10, obs.height - 10);
                }
            });
        }

        function drawCoins() {
            coinObjects.forEach(coin => {
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.arc(coin.x, coin.y, coin.radius, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#FFA500';
                ctx.lineWidth = 2;
                ctx.stroke();
                ctx.fillStyle = '#FFA500';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('$', coin.x, coin.y + 4);
            });
        }

        function drawClouds() {
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            clouds.forEach(cloud => {
                ctx.beginPath();
                ctx.arc(cloud.x, cloud.y, cloud.width / 3, 0, Math.PI * 2);
                ctx.arc(cloud.x + cloud.width / 3, cloud.y - 10, cloud.width / 2.5, 0, Math.PI * 2);
                ctx.arc(cloud.x + cloud.width / 1.5, cloud.y, cloud.width / 3, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function drawTrack() {
            ctx.fillStyle = '#654321';
            ctx.fillRect(0, groundY + train.normalHeight + 10, canvas.width, 10);
            
            for (let i = 0; i < canvas.width; i += 40) {
                ctx.fillStyle = '#8B7355';
                ctx.fillRect(i + (frameCount % 40), groundY + train.normalHeight + 5, 30, 5);
            }
        }

        function updateGame() {
            frameCount++;
            
            if (frameCount % 15 === 0) {
                score++;
                document.getElementById('score').textContent = score;
            }

            if (score > 0 && score % 200 === 0) {
                gameSpeed += 0.5;
                speedMultiplier = Math.floor(gameSpeed / 5);
                document.getElementById('speed').textContent = speedMultiplier;
            }

            if (train.jumping || train.y < groundY) {
                train.velocityY += gravity;
                train.y += train.velocityY;

                if (train.y >= groundY) {
                    train.y = groundY;
                    train.velocityY = 0;
                    train.jumping = false;
                }
            }

            clouds.forEach(cloud => {
                cloud.x -= cloud.speed;
                if (cloud.x + cloud.width < 0) {
                    cloud.x = canvas.width;
                    cloud.y = Math.random() * 150 + 50;
                }
            });

            if (frameCount % 80 === 0) {
                const type = Math.random() > 0.5 ? 'rock' : 'tunnel';
                obstacles.push({
                    x: canvas.width,
                    y: type === 'rock' ? groundY + train.normalHeight - 40 : 0,
                    width: 40,
                    height: type === 'rock' ? 40 : 150,
                    type: type
                });
            }

            if (frameCount % 60 === 0) {
                coinObjects.push({
                    x: canvas.width,
                    y: Math.random() * 200 + 200,
                    radius: 15
                });
            }

            obstacles.forEach((obs, index) => {
                obs.x -= gameSpeed;
                if (obs.x + obs.width < 0) {
                    obstacles.splice(index, 1);
                }

                if (checkCollision(train, obs)) {
                    endGame();
                }
            });

            coinObjects.forEach((coin, index) => {
                coin.x -= gameSpeed;
                if (coin.x + coin.radius < 0) {
                    coinObjects.splice(index, 1);
                }

                const dist = Math.sqrt(Math.pow(coin.x - (train.x + train.width / 2), 2) + 
                                      Math.pow(coin.y - (train.y + train.height / 2), 2));
                if (dist < coin.radius + 20) {
                    coinObjects.splice(index, 1);
                    coins++;
                    score += 10;
                    document.getElementById('score').textContent = score;
                }
            });
        }

        function checkCollision(train, obs) {
            const trainTop = train.ducking ? train.y + 25 : train.y;
            const trainHeight = train.height;

            if (obs.type === 'rock') {
                return train.x < obs.x + obs.width &&
                       train.x + train.width > obs.x &&
                       trainTop + trainHeight > obs.y &&
                       trainTop < obs.y + obs.height;
            } else if (obs.type === 'tunnel') {
                if (train.x < obs.x + obs.width && train.x + train.width > obs.x) {
                    if (!train.ducking && trainTop < obs.height) {
                        return true;
                    }
                }
            }
            return false;
        }

        function drawGame() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#87CEEB';
            ctx.fillRect(0, 0, canvas.width, canvas.height * 0.7);
            
            ctx.fillStyle = '#90EE90';
            ctx.fillRect(0, canvas.height * 0.7, canvas.width, canvas.height * 0.3);
            
            drawClouds();
            drawTrack();
            drawCoins();
            drawObstacles();
            drawTrain();
        }

        function gameLoop() {
            if (!gameRunning) return;
            
            updateGame();
            drawGame();
            requestAnimationFrame(gameLoop);
        }

        function endGame() {
            gameRunning = false;
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalCoins').textContent = coins;
            document.getElementById('gameOver').style.display = 'block';
        }

        document.addEventListener('keydown', (e) => {
            if (!gameRunning) return;
            
            if (e.key === 'ArrowUp' && !train.jumping && train.y === groundY) {
                train.velocityY = jumpPower;
                train.jumping = true;
                train.ducking = false;
                train.height = train.normalHeight;
            }
            
            if (e.key === 'ArrowDown' && train.y === groundY) {
                train.ducking = true;
                train.height = train.duckHeight;
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowDown') {
                train.ducking = false;
                train.height = train.normalHeight;
            }
        });

        drawGame();
    </script>
</body>
</html>